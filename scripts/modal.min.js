!function(t){var i={shadow:!1,position:"absolute",originalWidth:"300px",redim:!1,redimWidth:"800px",redimLinkText:"Le communiqué dans son intégralité",redimLinkType:"link",redimLinkStyle:{},url:"/templates/defaultTemplate.html",animationSpeed:500},e=[{options:["position","originalWidth","redimLinkText","redimLinkType","redimWidth","url","background","padding","margin"],type:"string"},{options:["animationSpeed","borderRadius"],type:"number"},{options:["redim","shadow","closable"],type:"boolean"},{options:["redimLinkStyle"],type:"object"}],s=["originalWidth","redimWidth"],o=new RegExp(/^[0-9]+(px|pt|pc|in|cm|mm|em|ex|ch|rem|vw|vh|vmin|vmax|%)$|^calc\(.+\)$/),n=new RegExp(/^calc\(.+\)$/);var a={DOMelement:null,init:function(){var i=t("body");null==this.DOMelement&&(this.DOMelement=t(document.createElement("div")).addClass("overlay"),0==i.find(this.DOMelement).length&&i.append(this.DOMelement)),this.display(!0)},display:function(i){t(this.DOMelement)[i?"addClass":"removeClass"]("display")}};function r(){this.DOMtag=null,this.settings=null,this.dimensions={height:0,width:0},this.positions={top:0,left:0}}function d(){r.call(this),this.redimBt="",this.classShadow="",this.templatesText=null,this.key=null}function l(){r.call(this)}r.prototype.getSize=function(t,i){this.dimensions.height=this.DOMtag.outerHeight(),!this.DOMtag.is("#clone_modal_"+i)||n.test(t)?this.dimensions.width=this.DOMtag.outerWidth():this.DOMtag.is("#clone_modal_"+i)&&(this.dimensions.width=t)},r.prototype.getPosition=function(){this.positions.left=this.DOMtag.offset().left,this.positions.top=this.DOMtag.offset().top-t(document).scrollTop()},r.prototype.scopeCSS=function(i,e,s){var o=[],n=0,a=[];if(t.parseHTML(i).filter(function(t){8!=t.nodeType&&(3!=t.nodeType||3==t.nodeType&&""!=t.textContent.trim())&&("STYLE"==t.nodeName&&a.push(n),o.push(t),n++)}),0==a.length)return i;for(var r="",d=[],l=0;l<o.length;l++)if(-1==a.indexOf(l))r+=3==o[l].nodeType?o[l].textContent:o[l].outerHTML;else{var h=o[l].innerHTML.replace(/\/\*[\s\S]*?\*\/.*$/gm,"").split("}").map(t=>t="#"+e+s+" "+t.trim()+"}");h.splice(d.length-1,1),d=d.concat(h)}return(d="<style>"+d.join(" ")+"</style>")+r},d.prototype=Object.create(r.prototype),d.prototype.init=function(i,e){this.DOMtag=t(i),this.settings=e;var s="            <i class='fas fa-times "+(this.settings.closable?"":"hidden")+"' id='closeShortMsg'></i>            <div class='TexteInfoFocus' "+("padding"in this.settings?"style='padding: "+this.settings.padding+"'":"")+" >                <div class='TexteInfoFocusContenu'></div>            </div>",o={width:this.settings.originalWidth};"background"in this.settings&&(o.background=this.settings.background),"margin"in this.settings&&(o.margin=this.settings.margin),"boxShadow"in this.settings&&(o["box-shadow"]=this.settings.boxShadow),"borderRadius"in this.settings&&(this.classShadow="br-"+this.settings.borderRadius.toString()),this.DOMtag.removeAttr("style").attr("data-modal",!0).html(s).css(o).addClass(this.classShadow);var n=this.settings.position;"float"==n.substring(0,5)?this.DOMtag.addClass("floatLeft"===n?"float left":"floatRight"===n?"float right":""):"fixed"==n&&this.DOMtag.addClass(n);var a=this;this.DOMtag.on("click","#closeShortMsg:not(.hidden)",function(){a.onClose()}),this.loadData()},d.prototype.onClose=function(){this.DOMtag.removeClass("display")},d.prototype.loadData=function(){var i=this;t.get(this.settings.url,function(e){i.key=i.createKey();var s=t(e).filter("#tpl_default").text(),o=ejs.render(s);o=i.scopeCSS(o,i.key,"_default"),i.templatesText=e,i.setLinkToRedim(),i.DOMtag.find(".TexteInfoFocusContenu").attr("id",i.key+"_default").html(o).append(i.redimBt),i.DOMtag.addClass("display")})},d.prototype.display=function(t){1==this.settings.shadow?t?this.DOMtag.removeClass("setShadow").find(".shadow").remove():this.DOMtag.addClass("setShadow").prepend("<div class='shadow "+this.classShadow+"'></div>"):this.DOMtag[t?"removeClass":"addClass"]("Hidden")},d.prototype.createKey=function(){var t=Math.round(1e3*Math.random()),i="abcdefghijklmnopqrstuvwxyz",e=Math.floor(i.length*Math.random());return e==i.length&&(e=i.length-1),i.substr(e,1)+t},d.prototype.setLinkToRedim=function(){if(this.settings.redim){var i="link"==this.settings.redimLinkType?"linkToRedimModal":"button"==this.settings.redimLinkType?"fakeButtonToRedimModal":"";this.redimBt=t(document.createElement("a")).addClass(i).css(this.settings.redimLinkStyle).text(this.settings.redimLinkText);var e=this;this.redimBt.on("click",function(){e.getDataModalRedim()})}},d.prototype.getDataModalRedim=function(){var i=this.templatesText;if(t(i).filter("#tpl_redim").length>0){var e=t(i).filter("#tpl_redim").text();this.createCloneModal(e)}},d.prototype.createCloneModal=function(t){(new l).init(this,t)},l.prototype=Object.create(r.prototype),l.prototype.init=function(i,e){console.log("Dans 'CloneModal.prototype.init' : originalModal.key",i.key);var s=i.settings,o=i.key;a.init(),this.DOMtag=i.DOMtag.clone().attr("id","clone_modal_"+o).css("margin","").removeClass("float right left fixed display").addClass("setCentralPosition");e=this.scopeCSS(e,o,"_redim"),this.DOMtag.appendTo("body").css({width:s.redimWidth}).find(".TexteInfoFocusContenu").attr("id",o+"_redim").html(ejs.render(e)),this.btGetSmall=this.DOMtag.find("#closeShortMsg").removeClass().addClass("fas fa-compress-arrows-alt").attr({id:"IconeResizeSmall",title:"Réduire cette fenêtre"});var r=this;this.btGetSmall.on("click",function(){r.redimToOriginalSize(i)}),i.display(!1),this.getPosition(),this.getSize(s.redimWidth,o),i.getPosition(),i.getSize(s.redimWidth,o),this.DOMtag.outerHeight(i.dimensions.height).outerWidth(i.dimensions.width).css({top:i.positions.top,left:i.positions.left}).removeClass("Hidden setCentralPosition").children().addClass("Hidden"),this.DOMtag.addClass("transition").animate({left:this.positions.left,top:this.positions.top,width:this.dimensions.width,height:this.dimensions.height},s.animationSpeed,function(){t(this).css({top:"",left:"",height:""}).addClass("setCentralPosition").children().removeClass("Hidden"),n.test(s.redimWidth)&&t(this).css({width:s.redimWidth})})},l.prototype.redimToOriginalSize=function(i){var e,s;console.log("Dans 'CloneModal.prototype.redimToOriginalSize' : originModal.key",i.key),e=window.pageYOffset||document.documentElement.scrollTop,s=window.pageXOffset||document.documentElement.scrollLeft,window.addEventListener("scroll",noScroll=function(){window.scrollTo(s,e)}),this.getPosition(),this.DOMtag.removeClass("setCentralPosition").css({top:this.positions.top,left:this.positions.left}).children().addClass("Hidden");var o=i.settings;i.getPosition(),i.getSize(o.redimWidth,i.key),this.DOMtag.animate({left:i.positions.left,top:i.positions.top,width:i.dimensions.width,height:i.dimensions.height},o.animationSpeed,function(){a.display(!1),t(this).fadeOut("300",function(){t(this).remove()}),i.display(!0),window.removeEventListener("scroll",noScroll)})},t.fn.setModal=function(t){var n=this;if(!("fonts"in document))throw Error("Votre navigateur n'est pas compatible avec cette librairie. Veuillez utiliser un navigateur plus récent.");document.fonts.ready.then(function(){n.each(function(){var n=Object.assign({},i,t);try{for(var a of e)for(var r of a.options)if(void 0!==n[r]&&typeof n[r]!==a.type)throw new Error("La valeur pour déterminer l'option '"+r+"' doit être de type '"+a.type+"' !!");for(r of s)if(0==o.test(n[r]))throw new Error("L'option '"+r+"' est incorrect (valeur erronée => "+n[r]+")");if("block"!==n.position&&"absolute"!==n.position&&"fixed"!==n.position&&"floatLeft"!==n.position&&"floatRight"!==n.position)throw new Error("Les valeurs possibles pour l'option 'position' sont: 'block', 'absolute', 'fixed, 'floatLeft' et 'floatRight'");if("link"!==n.redimLinkType&&"button"!==n.redimLinkType)throw new Error("Les valeurs possibles pour l'option 'redimLinkType' sont 'link' ou 'button'");if(n.borderRadius<1||n.borderRadius>25)throw new Error("La valeur pour l'option 'borderRadius' doit être comprise entre 1 et 25")}catch(t){console.error(this,`setModal() => ERREUR dans la configuration de l'encart : ${t.message}`)}(new d).init(this,n)})})}}(jQuery);